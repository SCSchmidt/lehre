---
title: "lösungen_b17"
author:
  - Sophie C. Schmidt:
      email: s.c.schmidt@uni-koeln.de
      correspondence: true
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  md_document:
    variant: markdown_github
always_allow_html: true

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Lösung Aufgabe logistische Regression (B 17)

```{r}
library(palmerpenguins)
data("penguins")

penguins <- subset(penguins, penguins$species == "Gentoo")
penguins$sex <-  as.character(penguins$sex) # das muss sein, weil ich einem Faktor keine anderen Werte geben kann als die, die vorher definiert wurden (female und male)
penguins$sex[penguins$sex == "female"] <- "0"
penguins$sex[penguins$sex != "0"] <- "1"

penguins$sex <- as.numeric(as.character(penguins$sex))

```

2. Logit berechnen: 

**Aufgabe** Füllt diese Syntax aus und berechnet das logit!


3. **Aufgabe** Die Summary-Statistik des Logit auswerfen lassen:

```{r}
mylogit <- glm(sex ~ body_mass_g + flipper_length_mm, data = penguins, family = "binomial")


summary(mylogit)

```


4. **Aufgabe:** Diskutiert die Ergebnisse in eurer Gruppe!
Was sagt das Estimate? Wie signifikant sind die Ergebnisse? 

5. **Aufgabe:** Berechnet die Veränderung der Chance, wenn das Gewicht zwischen 4000-5000 oder 5000 - 6000 liegt, die Länge der Flossen aber der Mittelwert bleibt.

Denkt daran, die Syntax von values trennt die Werte der beiden Parameter mit Semikolon, aber die Spezifizierung der Schritte der Werte des ersten Parameter muss mit Komma von dem Parameterwerten getrennt werden. Es gibt die Möglichkeit, den Mittelwert eines Parameters festzulegen, indem an seine Stelle `mean` schreibt: `values = "Spannbreite d. 1. Parameters den ich betrachten möchte,Schritte für Gruppenbildung;Mittelwert 2. Parameters"`

```{r}
library(glm.predict)
predicts(model = mylogit, values = "4000-6000,1000;mean", position = 1) 

```

Wie kann man dieses Ergebnis diskutieren?

Jetzt berechnet noch die odds Ratio 

```{r}
exp(coef(mylogit))
```

und visualisieren den Faktor Gewicht:

```{r}

library(ggplot2)
  ggplot(data = penguins, 
         aes(body_mass_g , # logit-modell unabhängige Variable
             sex)) + # abhängige variable
  geom_point(alpha = 0.2) + # Transparenz
  geom_smooth(method = "glm", # Methode
              method.args = list(family = "binomial")) + # binomial angeben
  labs(title = "Logistic Regression Model",  # Beschriftungen
       x = "in Abhängigkeit von Gewicht", 
       y = "Chance Männchen zu sein")


```
